# =============================================================================
# mosquitto.conf - Configuración de Mosquitto MQTT para App-Turnos (Docker)
# =============================================================================
#
# Este archivo configura el broker MQTT Mosquitto para uso en Docker:
# - Conexiones TCP en puerto 1883
# - Conexiones WebSocket en puerto 9001 (para navegadores)
# - Modo anónimo habilitado
# - Persistencia de mensajes
#
# =============================================================================

# =============================================================================
# Listeners
# =============================================================================

# Listener TCP estándar para clientes MQTT (0.0.0.0 para red Docker interna)
listener 1883 0.0.0.0
protocol mqtt

# Listener WebSocket para navegadores (accesible via Caddy proxy en red Docker)
listener 9001 0.0.0.0
protocol websockets

# =============================================================================
# Autenticación
# =============================================================================

# Permitir conexiones anónimas
allow_anonymous true

# =============================================================================
# Persistencia
# =============================================================================

persistence true
persistence_location /mosquitto/data/

# Intervalo de guardado automático (en segundos)
autosave_interval 60

# =============================================================================
# Logging
# =============================================================================

log_dest stdout
log_type error
log_type warning
log_type notice
log_type information
log_timestamp true

# =============================================================================
# Conexiones
# =============================================================================

max_connections -1
max_keepalive 60

# =============================================================================
# Mensajes
# =============================================================================

message_size_limit 1048576
max_qos 2
